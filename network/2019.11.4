### 1. 웹서버의 설치 장소

- 사내 웹서버를 설치하는 경우
    - IP주소의 부족 : 서버를 LAN에 설치하면 클라이언트 에도 글로벌 주소를 할당해야 한다.
    - 보안상의 이유 : 서버는 사소한 설정 실수 등으로 보안상의 탈출구가 생길 수 있는 데, 방치 상태라면 보안 구멍이 무방비상태가 된다.
    - 그래서 방화벽이 필요하다.
- 데이터센터에 웹 서버를 설치하는 경우
    - 데이터센터는 프로바이더의 중심 부분에 있는 NOC에 직접 접속 되었거나 프로바이더들이 상호 접속하는 IX 에 직격되어 있다. 인터넷 중심 부분에 고속회선으로 접속되있기 떄문에 서버를 설치하면 고속으로 액세스 할 수 있다.

### 2. 방화벽의 원리와 동작

1. 패킷 필터링형이 주류이다. 
    - 패킷 필터링형이 가장 많은데 그 이유는 성능, 가격 편의성등이다.
2. 패킷 필터링의 조건 설정 개념
    - 송신처나 수신처의 IP를 조건으로 설정할 수 있다. 그 IP를 바탕으로 통과시킬 것인지, 차단할 것인지 결정한다.
    - 방화벽에서는 불 필요한 웹이외의 애플리케이션의 패킷은 전부 차단하는 것이 좋다.
3. 그래서 웹 애플리케이션으로 한정할 떄에는 TCP 헤더등에 기록되어 있는 포트번호를 조건으로 추가한다. 
4. 컨트롤 비트로 접속 방향을 판단한다.
    - 웹서버에서 인터넷으로 흐르는 패킷을 정지시키면 인터넷에서 웹 서버에 액세스하는 동작도 정지된다.
    - 그래서 3 hand shake의 최초 패킷은  Syn이 1이고 Ack가 0인데, 이것을 차단하면 당연히 접속이 실패한다.
- 이렇게 다양한 조건으로 필터를 한다.
- 하지만 통과와 차단을 완전히 선별할 수 없는 경우가 있는 데 DNS서버에 조회하는 동작에 대한 경우이다.
- DNS 서버 접속은  UDP로 이루어지고 컨트롤 비트가 없기 때문에 패킷을 전부 통과시키거나 애플리케이션을 전면적으로 차단하는 방법이 있다.

5. 사내 LAN에서 공개 서버용 LAN 으로 조건을 설정한다. 

- 주소변환 설정으로 필터링을 할 수 있다.

6. 방화벽 통과

- 차단하는 패킷을 버리고, 버린기록을 남긴다.
- 방화벽은 라우터의 연장선이다. 라우터의 기능중 패킷 필터링이라는 기능이 있는 데, 그 조건이 복잡해지면서 전용 소프트웨어를 사용하는 것이다. 그래서 간단한 필터링이라면 일반 라우터를 방화벽으로 사용할 수도 있다.

### 3. 복수 서버에 리퀘스트를 분배한 서버의 부하 분산

1. 처리 능력이 부족하면 복수 서버로 부하 분산된다.
- 부하 분산을 하기위한 방법이 여러가지가 있는 데, DNS 서버에서 분배하는 방법이 가장 간단하다.
    - DNS서버에 같은 이름으로 여러 대의 웹 서버를 등록해 놓으면 DNS 서버는 조회가 있을 때마다 차례대로  IP 주소를 되돌려줍니다.
    - 예를들어 www.naver.com이 있는 데, 이 서버의 IP주소는 192.0.2.60, 192.0.2.70, 192.0.2.80 이렇게 3가지로 나눠져 있다고 한다면, 요청에 대한 응답을

        192.0.2.60, 192.0.2.70, 192.0.2.80 
        192.0.2.70, 192.0.2.80, 192.0.2.60 
        192.0.2.80, 192.0.2.60, 192.0.2.70

    이러한 방식을 라운드로빈 이라고 한다!!

- 이 방법의 결점은 웹서버가 많으면 고장나는 웹서버도 있는데 그 웹서버 주소도 응답을 한다. 왜냐하면 DNS서버는 그것을 모르기 떄문에..

2. 부하 분산 장치를 이용해 복수의 웹 서버로 분할된다. 

- 부하분산장치와 로드 밸런서등으로 이제 해결한다.
- 먼저 부하 분산 장치의 IP주소를  DNS서버에 등록한다.
- 그리고 부하분산 장치의 이름을 웹 서버와 동일하게 이름을 붙이고 DNS서버에 등록해 놓는 것이다.
- 그러면 클라이언트는 부하 분산 장치의 IP주소를 응답받는다.
- 그럼 이제 어느 웹 서버에 보낼지를 생각해야 되는 데, 일단 복수의 페이지에 걸쳐 있는지 아닌지가 중요한 판단 기준이 된다.
- 복수의 페이지가 아니라면 웹서버의 부하 상태가 판단근거가 된다.
- 그런데 복수의 페이지 인지 아닌지 판단하기 위해서 HTTP 통신 규약에 추가된 것이 쿠키이다.